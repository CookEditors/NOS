<!doctype html>
<html lang="en-US">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<title>test 2 &#124; Tales of Murder</title>
		
		
		
		<!-- include open-graph.html w/ open moustache/percent-->

		<!-- Webmaster Tools Verification -->
		

		

		<!-- CSS -->
		<link rel="stylesheet" href="/assets/css/styles.css">
		
		<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
	
		<!--[if lt IE 9]>
    	<script src="bower_components/html5shiv/dist/html5shiv.js"></script>
    	<script src="_assets/js/vendor/respond.js"></script>
		<![endif]-->

		<!-- Scripts -->
		<script src="/assets/js/vendor/modernizr.custom.34164.js"></script>
		<!-- <script src="/assets/js/vendor/classie.js"></script>
		<script src="/assets/js/vendor/nav.js"></script> -->

		<script src="/assets/js/vendor/jquery-1.11.2.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js"></script>


		<script src="/assets/js/vendor/store.js"></script>

		<!-- <script src="/assets/js/vendor/velocity.min.js"></script> -->


		<!-- TYPEKIT -->
		<script src="//use.typekit.net/gwl0zuj.js"></script>
		<script>try{Typekit.load();}catch(e){}</script>

		<!-- Icons [http://tinyurl.com/nf7m64p] -->

	</head>

















<body  id="test 2" class="ipadBS">

  <main class="main" roll="main" style="height:100%;">
    <div class="content">
      <header class="flextest__header">
	
	<div class="container">
		
		<div class="flextest__masthead">

			<img src="/assets/img/circle_crow_paper.png" alt="" class="flextest__logo">

			<div class="flextest__branding">

				<h2 class="flextest__titles"><span class="flextest__title-sub">Tales of </span><span class="flextest__title-main"><span class="m">m</span><span class="urde">urde</span><span class="r">r</span></span></h2>

				<h3 class="flextest__tagline">For readers with time to <span>kill</span> &hellip;</h3>

			</div> <!-- end div.flextest__branding -->
			
		</div> <!-- end div .flextest__masthead -->

		<div class="flextest__navicon">
			<p>NAV</p>
		</div> <!-- end .flextest__navicon -->

		<!-- <nav></nav> -->

	</div> <!-- end div .container -->

</header> <!-- end header .flextest__header -->










    </div>

  </main>
  
  <!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script> -->

<!--load jQuery, required-->
<script src="/assets/js/vendor/jquery-1.11.2.js"></script>

<script src="/assets/js/vendor/jquery-ui.min.js"></script>

<!--load jPushMenu, required-->
<script src="/assets/js/vendor/jPushMenu.js"></script>

<script src="/assets/js/vendor/slabtext.js"></script>

<script src="/assets/js/vendor/scroll-on-page.js"></script>

<!-- <script src="/assets/js/vendor/store.js"></script>
NOTE: moved to HEAD -->
<script src="/assets/js/vendor/flipclock.min.js"></script>

<!-- <script src="/assets/js/vendor/expandable-section.js"></script> -->

<!-- velocity.js -->
<script src="/assets/js/vendor/velocity.min.js"></script>




<!-- animated progbar -->
<script>
  function MoveTo() {
    var prpos = document.getElementById('prpos');
    prpos.style.width = document.getElementById('moveTo').value + "%";
  } 
</script>

<!--call jPushMenu, required-->
<script>
  jQuery(document).ready(function($) {
   $('.toggle-menu').jPushMenu();
 });
</script>

<!-- <script src="/assets/js/vendor/rwd.js"></script> -->

<script>
	$("h1").slabText({});
</script>

<script type="text/javascript">
	$(document).ready(function() {
    var expanderTrigger = document.getElementById("js-expander-trigger");
    var expanderContent = document.getElementById("js-expander-content");

    $('#js-expander-trigger').click(function(){
      $(this).toggleClass("expander-hidden");
    });
  });
</script>

<script>

  (function() {

   var co = $('article').find('span.co').each(function() {
    var $this = $(this);

    $('<blockquote></blockquote>', {
     class: 'co',
     text: $this.text()
   }).prependTo( $this.closest('p') );

  });

 })();

</script>




<script>
  function regExpand() {
    console.log("button works!")
  }
</script>


<script> 
  $(document).ready(function(){
    $("#register__button").click(function(){
      $("#panel").slideDown("5000", "easeOutBounce");
    });
  });
</script>


<script type='text/javascript'>
  $(document).ready(function() {
    $(".time").text(function (index, value) {
      return Math.round(parseFloat(value));
    });
    $(".hour").text(function (index, value) {
      return Math.floor(parseFloat(value));
    });
  });
</script>

<!-- this is the simple working version to set localStore attributes ... not used in lieu of callback at the end of ajaxMailChimp (below) -->
<!-- <script>
	
	$(document).ready(function() {

		init()

		function init() {
			if (!store.enabled) {
				alert('Local storage is not supported by your browser. Please disable "Private Mode" to continue, or upgrade your browser.')
				return
			}
			$("#regSubmit").click(function() {
        store.set('registered', true);

        var email = $("#regEmail").val();
        store.set('email', email)

      })
		};
	})

</script> -->

<!-- CHECK LOCAL STORAGE -->
<!-- can I name this function/script?? -->
<script> 
	
	$(document).ready(function() {
		if ($("#thepost").hasClass("premium_post")) {
			console.log("Premium Post")
			
			if (!store.get('registered')) {
				console.log('UNREGISTERED User');
				$(".pc-tease").removeClass("hidden");
				$(".cu-tease").hide();
				$(".ssactions").hide();

				$(".read-more").removeClass("hidden");
				$("#thepost").addClass("notreg")
			}
			else {
				console.log('REGISTERED User');
                // console.log(email)
            }
            }
      else { 
             console.log("Post")
           }
         }) 
</script>




<!-- MAILCHIMP FORM STUFF -->

<!-- mailchimp-ajax.js -->
<script>
 var ajaxMailChimp = (function(){
 var module = {};

// Turn the given MailChimp form into an ajax version.
// If resultElement is given, the subscribe result is set as html to
// that element.
module.init = function ajaxMailChimpForm($form, $resultElement){

    // Hijack the submission. We'll submit the form manually.
    $form.submit(function(e) {
      e.preventDefault();

      if (!isValidEmail($form)) {
        var error =  "A valid email address must be provided."
        $resultElement.html(error);
        $resultElement.css("color", "red");
      } else {
        $resultElement.css({
         "background-color": "#fff",
         "color": "#8B0000",
         "margin-top": "1rem",
         "padding": "0.5rem"
       });
        $resultElement.html("Registering your download request &hellip;");
        $("#progress-bar").css("width", "75%").text("75%");
        submitSubscribeForm($form, $resultElement);
      }
    });
  };

// Validate the email address in the form
function isValidEmail($form) {
    // If email is empty, show error message.
    // contains just one @
    var email = $form.find("input[type='email']").val();
    if (!email || !email.length) {
      return false;
    } else if (email.indexOf("@") == -1) {
      return false;
    }

    return true;
  }

// Submit the form with an ajax/jsonp request.
// Based on http://stackoverflow.com/a/15120409/215821
function submitSubscribeForm($form, $resultElement) {
  $.ajax({
    type: "GET",
    url: $form.attr("action"),
    data: $form.serialize(),
    cache: false,
    dataType: "jsonp",
    jsonp: "c", // trigger MailChimp to return a JSONP response
    contentType: "application/json; charset=utf-8",

    error: function(error){
    // According to jquery docs, this is never called for cross-domain JSONP requests
  },

    success: function(data){
      if (data.result != "success") {
        var message = data.msg || "Sorry. Unable to subscribe. Please try again later."
        $resultElement.css("color", "red");

        // This won't happen if using "smart subscribe"
        if (data.msg && data.msg.indexOf("already subscribed") >= 0) {
          message = "You're already subscribed. Thank you."
          $resultElement.css("color", "white");
        }

        $resultElement.html(message);

        }

      else {
        if ($("#mc-embedded-subscribe-form").hasClass("form__premium")) {
          console.log("premium form");
          var message = "Thank you!! Please continue reading &hellip;";
          location.reload(); //reloads the premium post page at same location
        }
        else if ($("#mc-embedded-subscribe-form").hasClass("form__postdownload")) {
          console.log("post download form");
          var message = "Thank you!!<br>You are subscribed &amp; you can download your story next &hellip;";
          var url = "/downloads/short-stories/index.html"; // needs to be dynamically created for *each* story ... will use localStorage cookie (maybe!)

          $(location).attr('href', url);
        }
        else if ($("#mc-embedded-subscribe-form").hasClass("form__wg")) {
          console.log("wg form");

          var url = "/thanks/theredfile/";

          $(location).attr('href', url);
        }
        else {
          console.log("no class whatsoever!");
        }

        $resultElement.html(message);
        
        var email = $("#mce-EMAIL").val();
        store.set('registered', true);
        store.set('emailaddress', email); 

      } // end of else statement
    }
  });
}

return module;

})();
</script>


<!-- sets story data (title, author, etc.) to localStorage/sessionStorage for use on download page -->
<script>
  
$(document).ready(function() {

  $("#button__postdownload").click(function() {
    // console.log("button__postdownload clicked");
    var url; // should be available throughout click function
    
    init()
    function init() {
      if (!store.enabled) {
        var url = "/downloads/short-stories/index-other.html"; //GENERIC DOWNLOAD PAGE
        alert('Local storage is not supported by your browswer. Please disable "Private Mode", or upgrade your browser.')
      return
      } // end of if !store.enabled

      var url = "/downloads/short-stories/index2.html";         
      var metaArray = ["test 2", "", "", "", "", "", "", ""];

      // ARRAY KEY
      // [0] = title
      // [1] = author
      // [2] = genre
      // [3] = image
      // [4] = excerpt
      // [5] = kindle url
      // [6] = epub url
      // [7] = pdf url   

      store.set('storyMeta', JSON.stringify(metaArray));

      console.log(metaArray);
    } // end of function init()

    if (store.get('registered')) {
      console.log("registered user!");
      console.log(url);

      var emailaddress = store.get('emailaddress');
      console.log(emailaddress);
      $('#mce-EMAIL').val(emailaddress);
      // $(location).attr('href', url);  sends past modal to download page .. not currently working due to val = url issue!
    } // end if 

  }); // end of click function
});
</script>


<!-- retrieve localStorage arrage & dump into page elements -->
<script>
  var retrievedMetaString = store.get("storyMeta");
  
  if (retrievedMetaString) {
    var retrievedMetaArray = JSON.parse(retrievedMetaString);
    document.getElementById("title").innerHTML = retrievedMetaArray[0];
    document.getElementById("author").innerHTML = retrievedMetaArray[1];
    document.getElementById("genre").innerHTML = retrievedMetaArray[2];
    document.getElementById("image").src = retrievedMetaArray[3];
    document.getElementById("excerpt").innerHTML = retrievedMetaArray[4];
    document.getElementById("kindle").href = retrievedMetaArray[5];
    document.getElementById("epub").href = retrievedMetaArray[6];
    document.getElementById("pdf").href = retrievedMetaArray[7];

    $(".download-title").html(retrievedMetaArray[0]);
}
</script>


<!-- WG reveal -->
<script>
  
  $(document).ready(function(){
    $(".reveal__button").click(function(){
      $("#revealer").hide();
      $(".reveal__answer p").removeClass("answer__hidden");
      $("#top-p").css({
        "font-weight": "bold"
      });
      $("#last-p").css({
        'color' : 'darkred',
        'fontWeight' : 'bold',
        'fontSize' : '1rem'
      });
      $(".reveal__answer").css({
        'border-color' : 'darkred',
        'border-size' : '2px'
      });
    })
  });
</script>



































</body>